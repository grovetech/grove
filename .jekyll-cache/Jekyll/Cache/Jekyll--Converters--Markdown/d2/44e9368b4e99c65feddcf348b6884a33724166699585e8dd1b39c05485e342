I"M<p>Apple has changed decades ago by introducing to the world single window applications. Ever since we have seen tremendous applications all taking advantage of this form. Functionality that compliments that form are things like window sheets, those cool pop-under windows that slide up and down from the top of the application top bar. Sheets magically show us controls when we need them and then whoosh them away when we donâ€™t.</p>

<p>Not surprisingly Apple has built in controls for system level windows to use this wonderful technology. However its not very commonly known how to do so with common system windows like Print Dialogue boxes and page layout windows. I recently started working on a Cocoa project where the goal was to keep everything contained in the single window concept.</p>

<p>It took me a while to figure out how to use the delegates that Apple built into these two windows in order to have them display by default as a sheet. I hope that this article helps others struggling with the same problem.</p>

<p><img src="https://grovetech.co/assets/images/blog/2013/12/printview.png" alt="printview" width="716" height="616" class="aligncenter size-full wp-image-1038" /></p>

<p>First create a custom class in my case I created a subclass of NSObject called Print_View.m/h.</p>

<p>Print_View.h : Subclass of NSObject</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#import &lt;Foundation/Foundation.h&gt;</span>

@interface Print_View : NSObject
<span class="o">{</span>
    IBOutlet <span class="nb">id </span>PrintView<span class="p">;</span>
    IBOutlet <span class="nb">id </span>window<span class="p">;</span>
    IBOutlet <span class="nb">id </span>MainWindow<span class="p">;</span>
<span class="o">}</span>

- <span class="o">(</span>IBAction<span class="o">)</span>pagesetup:<span class="o">(</span><span class="nb">id</span><span class="o">)</span>sender<span class="p">;</span>
- <span class="o">(</span>IBAction<span class="o">)</span>print:<span class="o">(</span><span class="nb">id</span><span class="o">)</span>sender<span class="p">;</span>

@end</code></pre></figure>

<p>Notice here that I created 3 outlets and 2 senders. The PrintView outlet should be connected to the view, or text element in the NSWindow that you want to print. This is important, the delegate will not work until you declare the thing that the application will be printing.</p>

<p>the window and MainWindow outlets need to be connected to the main window in your XIB file. Finally the senders need to be connected to the File &gt; Print, and File &gt; Page Setup menu items respectively.</p>

<p><img src="https://grovetech.co/assets/images/blog/2013/12/Screen-Shot-2013-11-09-at-10.31.25-PM.png" alt="Screen Shot 2013-11-09 at 10.31.25 PM" width="1514" height="934" class="aligncenter size-full wp-image-1039" /></p>

<p><img src="https://grovetech.co/assets/images/blog/2013/12/Screen-Shot-2013-11-09-at-10.32.36-PM.png" alt="Screen Shot 2013-11-09 at 10.32.36 PM" width="1514" height="934" class="aligncenter size-full wp-image-1040" /></p>

<p>Print_View.m : Subclass of NSObject</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#import "Print_View.h"</span>
@implementation Print_View
- <span class="o">(</span>IBAction<span class="o">)</span>print:<span class="o">(</span><span class="nb">id</span><span class="o">)</span>sender <span class="o">{</span>
    NSPrintOperation<span class="k">*</span> printOperation <span class="o">=</span> <span class="o">[</span>NSPrintOperation printOperationWithView:PrintView]<span class="p">;</span>
    <span class="o">[</span>printOperation setCanSpawnSeparateThread:YES]<span class="p">;</span>
    <span class="o">[</span>printOperation runOperationModalForWindow:window delegate:window didRunSelector:nil contextInfo:nil]<span class="p">;</span>
<span class="o">}</span>

- <span class="o">(</span>IBAction<span class="o">)</span>pagesetup:<span class="o">(</span><span class="nb">id</span><span class="o">)</span>sender <span class="o">{</span>
    NSPrintInfo <span class="k">*</span>printInfo <span class="o">=</span> <span class="o">[</span>NSPrintInfo sharedPrintInfo]<span class="p">;</span>
    NSPageLayout <span class="k">*</span>pageLayout <span class="o">=</span> <span class="o">[</span>NSPageLayout pageLayout]<span class="p">;</span>
    <span class="o">[</span>pageLayout beginSheetWithPrintInfo:printInfo modalForWindow:window delegate:MainWindow didEndSelector:@selector<span class="o">(</span>pageLayoutDidEnd:returnCode:contextInfo:<span class="o">)</span> contextInfo:nil]<span class="p">;</span>
<span class="o">}</span>

- <span class="o">(</span>void<span class="o">)</span>pageLayoutDidEnd:<span class="o">(</span>NSPageLayout <span class="k">*</span><span class="o">)</span>pageLayout returnCode:<span class="o">(</span>int<span class="o">)</span>returnCode contextInfo:<span class="o">(</span>void <span class="k">*</span><span class="o">)</span>contextInfo
<span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span>returnCode <span class="o">==</span> NSOKButton<span class="o">)</span>
    <span class="o">{</span>
    <span class="o">}</span>
<span class="o">}</span>
@end</code></pre></figure>

<p>As you can see the above code triggers the system dialogue boxes and treats them as sheets to the window with a delegate of MainWindow. You will also notice that the page setup has a function called pageLayoutDidEnd this is a place where you can enable custom functionality after the OK button is pressed, if you do not wish any other functionality then the window exits and the page prints.</p>
:ET